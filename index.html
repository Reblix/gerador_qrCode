<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Gera teu QR Code ai TST</title>
  <link rel="preconnect" href="https://cdnjs.cloudflare.com" />
  <style>
    :root{
      --bg:#0f172a;        /* slate-900 */
      --card:#111827;      /* gray-900 */
      --text:#e5e7eb;      /* gray-200 */
      --muted:#9ca3af;     /* gray-400 */
      --brand:#22c55e;     /* emerald-500 */
      --brand-2:#16a34a;   /* emerald-600 */
      --danger:#ef4444;    /* red-500 */
    }
    *{box-sizing:border-box}
    body{
      margin:0; background:linear-gradient(180deg,#0b1023,#0f172a);
      font:16px/1.4 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial,sans-serif;
      color:var(--text); min-height:100svh; display:grid; place-items:center; padding:24px;
    }
    .app{width:min(920px,100%); margin-inline:auto}

    /* Cabeçalho com logo */
    header.brand{
      display:grid; gap:8px; align-items:center; justify-items:center; text-align:center;
      margin-bottom:20px;
    }
    @media (min-width:640px){
      header.brand{grid-template-columns:auto 1fr; text-align:left; justify-items:start}
    }
    .logo-wrap{
      display:flex; align-items:center; justify-content:center;
      width:min(140px,40vw);
    }
    .logo{
      width:100%; height:auto; display:block; object-fit:contain;
      filter: drop-shadow(0 2px 6px rgba(0,0,0,.25));
    }
    h1{margin:0; font-size:clamp(20px,4vw,28px)}
    p.sub{margin:0; color:var(--muted)}

    .card{
      background:var(--card); border:1px solid #1f2937; border-radius:16px; padding:20px;
      box-shadow:0 10px 30px rgba(0,0,0,.25);
    }
    form{display:grid; gap:12px}
    .row{display:flex; gap:10px; flex-wrap:wrap}
    label{display:block; font-size:14px; color:var(--muted); margin-bottom:6px}
    input[type="url"]{
      flex:1 1 280px; min-width:240px; padding:14px 12px; border-radius:12px; border:1px solid #1f2937;
      background:#0b1224; color:var(--text); outline:none;
    }
    input[type="url"]::placeholder{color:#6b7280}
    .btn{
      appearance:none; border:0; border-radius:12px; padding:14px 16px; font-weight:600;
      background:var(--brand); color:#081316; cursor:pointer; transition:.2s transform ease, .2s background;
      white-space:nowrap;
    }
    .btn:hover{background:var(--brand-2); transform:translateY(-1px)}
    .btn.secondary{background:#1f2937; color:var(--text)}
    .btn.secondary:hover{background:#374151}
    .error{color:var(--danger); font-size:14px; min-height:1.2em}
    .result{margin-top:18px; display:grid; gap:12px; justify-items:center; text-align:center}
    .qr-card{
      display:grid; place-items:center; width:100%; max-width:520px;
      background:#0b1224; border:1px dashed #26324e; border-radius:12px; padding:16px;
    }
    canvas{max-width:100%; height:auto}
    .hidden{display:none !important}
    footer{margin-top:16px; text-align:center; color:#6b7280; font-size:13px}
  </style>
</head>
<body>
  <div class="app">
    <header class="brand" aria-label="Cabeçalho do aplicativo">
      <div class="logo-wrap">
        <picture>
          <source srcset="/assets/logo.svg" type="image/svg+xml" />
          <img class="logo" src="/assets/logo.png" alt="Logo do aplicativo" loading="eager" decoding="async" />
        </picture>
      </div>
      <div>
        <h1>Gerador de QR Code</h1>
        <p class="sub">Cole o link, clique em <strong>Gerar QR Code</strong> e depois em <strong>Baixar QR Code</strong>.</p>
      </div>
    </header>

    <section class="card">
      <form id="qr-form" novalidate>
        <div>
          <label for="url">Link (URL)</label>
          <div class="row">
            <input id="url" name="url" type="url" inputmode="url"
                   placeholder="https://exemplo.com" autocomplete="url" required />
            <button class="btn" id="genBtn" type="submit">Gerar QR Code</button>
          </div>
          <div id="err" class="error"></div>
        </div>

        <div id="result" class="result hidden" aria-live="polite">
          <div class="qr-card">
            <canvas id="qrCanvas" width="320" height="320" aria-label="QR Code gerado"></canvas>
          </div>
          <a id="downloadLink" class="btn secondary hidden" href="#" download="qr-code.png" rel="noopener">
            Baixar QR Code
          </a>
        </div>
      </form>
    </section>

    <footer>Desenvolvido por Felipe Reblin.</footer>
  </div>

  <!-- Biblioteca QRious (gera QR em <canvas>) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js" defer></script>

  <script>
    (function(){
      const form = document.getElementById('qr-form');
      const input = document.getElementById('url');
      const err = document.getElementById('err');
      const canvas = document.getElementById('qrCanvas');
      const result = document.getElementById('result');
      const downloadLink = document.getElementById('downloadLink');
      let qr;

      function calcSize(){
        const max = 520;
        const card = document.querySelector('.qr-card');
        const w = Math.min(max, Math.floor(card.clientWidth * 0.9));
        return Math.max(160, w);
      }

      function normalizeUrl(value){
        let v = (value || '').trim();
        if(!v) return '';
        try { return new URL(v).href; }
        catch(e){
          try { return new URL('https://' + v).href; }
          catch(e2){ return ''; }
        }
      }

      function makeFileName(urlStr){
        try{
          const u = new URL(urlStr);
          const host = (u.hostname || 'link').replace(/^www\./,'').replace(/[^\w.-]+/g,'-');
          const ts = new Date();
          const pad = n => String(n).padStart(2,'0');
          const stamp = `${ts.getFullYear()}${pad(ts.getMonth()+1)}${pad(ts.getDate())}-${pad(ts.getHours())}${pad(ts.getMinutes())}${pad(ts.getSeconds())}`;
          return `qrcode-${host}-${stamp}.png`;
        }catch{ return 'qrcode.png'; }
      }

      function updateDownload(){
        if(!qr) return;
        const dataUrl = qr.toDataURL('image/png');
        downloadLink.href = dataUrl;
        downloadLink.classList.remove('hidden');
      }

      function renderQR(value){
        const size = calcSize();
        if(!qr){
          qr = new QRious({ element: canvas, size, level: 'M', value });
        } else {
          qr.set({ size, value });
        }
        downloadLink.download = makeFileName(value);
        updateDownload();
      }

      window.addEventListener('resize', () => {
        if(qr){
          qr.set({ size: calcSize() });
          updateDownload();
        }
      });

      form.addEventListener('submit', (ev) => {
        ev.preventDefault();
        const normalized = normalizeUrl(input.value);
        if(!normalized){
          err.textContent = 'Informe um link válido (ex.: https://exemplo.com).';
          input.focus();
          return;
        }
        err.textContent = '';
        renderQR(normalized);
        result.classList.remove('hidden');
      });
    })();
  </script>
</body>
</html>
